---
title: "Estimating dose-specific cell division and apoptosis rates from chemo-sensitivity experiments"
author: "Yiyi Liu, Forrest Crawford"
date: "April 5, 2017"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

In this vignette, we give an example illustrating the usage of R package bdChemo.

Function bdChemo requires the following input:
z: compound concentrations (in log10 scale); a vector
x0: initial cell population sizes corresponding to concentrations in z; a vector (same length as z)
xt: cell population sizes at follow-up time corresponding to concentrations in z; a vector (same length as z)
x0c: control group (without compound treatment) initial cell population size; a scaler; for computing \eqn{GI_{50}}
xtc: control group (without compound treatment) cell population size at follow-up time; a scaler; for computing GI50
bk: background noise measurements

Other arguments with default values are:
N: number of iterations


```{r}
library("bdChemo")
data(example)
bd.example = bdChemo(z, x0, xt, x0c, xtc, bk, N = 1e5, plot.name = "example", sample.return = F)
```


The above code will produce a pdf file "example.pdf" with cell growth, birth and death rate curves as shown in Figure 3 of the manuscript. In addition, it also return a list "bd.example" with elements as described in users' manual. We will show the usage of these elements in the following code.

```{r}
## log concentrations where mu and lambda are returned
znew = bd.example$znew

## means and credible intervals of mu, lambda and Kendall Process at znew
lambda.mean = bd.example$lambdas[1,]
lambda.lower.bound = bd.example$lambdas[2,]
lambda.upper.bound = bd.example$lambdas[3,]
mu.mean = bd.example$mus[1,]
mu.lower.bound = bd.example$mus[2,]
mu.upper.bound = bd.example$mus[3,]
kmean.mean = bd.example$kmean[1,]
kmean.lower.bound = bd.example$kmean[2,]
kmean.upper.bound = bd.example$kmean[3,]

## means and credible intervals of GI50, TGI, LC50 and IC50
gi50.mean = bd.example$summary[1,1]
gi50.lower.bound = bd.example$summary[2,1]
gi50.upper.bound = bd.example$summary[3,1]

tgi.mean = bd.example$summary[1,2]
tgi.lower.bound = bd.example$summary[2,2]
tgi.upper.bound = bd.example$summary[3,2]

lc50.mean = bd.example$summary[1,3]
lc50.lower.bound = bd.example$summary[2,3]
lc50.upper.bound = bd.example$summary[3,3]

## posterior samples of mu and lambda (can be used to calculate other summary statistics of interest)
lambda.sample = bd.example$post.lambda
mu.sample = bd.example$post.mu
```
